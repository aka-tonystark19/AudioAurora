#include <stdio.h>
#include <system.h>
#include <sys/alt_irq.h>
#include <sys/alt_stdio.h>
#include <altera_avalon_timer_regs.h>
#include "math.h"
#include "complex.h"
#include "stdlib.h"
#include <sys/time.h>

typedef double complex cplx;
#define N 32

// Hardware timer functions
void init_isr(void);
static void hori_time_isr(void * context, alt_u32 id);
static void vert_time_isr(void * context, alt_u32 id);

// Running fft calculation to frequency recurrence
void runfft(int index);

// Updating one frame on vga
void runvga(int change);

//FFT code sampled from https://rosettacode.org/wiki/Fast_Fourier_transform
void fft(cplx buf[], int n);
void fft_helper(cplx buf[], cplx out[], int n, int step);
void printcplxArr(cplx arr[], int size);

// Global variables in system
int real[N];
int imag[N];
unsigned int magn[N];
unsigned int freq[N];
cplx output[N];

// Array to store the color values of the pixels
unsigned char image[160][120];
static int sizes[] = {50, 40, 30, 20, 10, 10, 20, 30, 40, 50, 50, 40, 30, 20, 10, 10, 20, 30, 40, 50};
static int colors[] = {0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001, 0b000001};
unsigned int data [] = {21321,
		21574,
		14,
		0,
		24908,
		26230,
		14389,
		14126,
		11830,
		12337,
		48,
		24932,
		24948,
		22016,
		71,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32895,
		32640,
		32639,
		32896,
		32895,
		32640,
		32640,
		32896,
		32896,
		32895,
		32895,
		32895,
		32895,
		32895,
		32895,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32640,
		32896,
		32895,
		32895,
		32896,
		32895,
		32639,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32895,
		32895,
		32896,
		32896,
		32896,
		32895,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32640,
		32895,
		32639,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32896,
		32895,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32895,
		32895,
		32895,
		32895,
		32640,
		32640,
		32639,
		32639,
		32639,
		32639,
		32640,
		32896,
		32896,
		32896,
		32640,
		32896,
		32639,
		32895,
		32896,
		32640,
		32895,
		32640,
		32896,
		32896,
		32895,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32640,
		32640,
		32640,
		32896,
		32896,
		32639,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32639,
		32896,
		32896,
		32640,
		32896,
		32895,
		32896,
		32639,
		32895,
		32895,
		32896,
		32896,
		32895,
		32640,
		32895,
		32896,
		32640,
		32895,
		32896,
		32896,
		32640,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32640,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32640,
		32895,
		32895,
		32896,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32640,
		32640,
		32896,
		32640,
		32639,
		32640,
		32640,
		32639,
		32896,
		32896,
		32639,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32895,
		32895,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32639,
		32896,
		32896,
		32639,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32639,
		32640,
		32896,
		32896,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32895,
		32895,
		32640,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32895,
		32639,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32895,
		32895,
		32896,
		32895,
		32896,
		32896,
		32895,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32895,
		32895,
		32640,
		32640,
		32639,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32895,
		32896,
		32896,
		32640,
		32640,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32639,
		32896,
		32895,
		32896,
		32896,
		32640,
		32640,
		32639,
		32895,
		32896,
		32896,
		32895,
		32640,
		32896,
		32896,
		32640,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32640,
		32640,
		32895,
		32896,
		32639,
		32640,
		32895,
		32640,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32639,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32895,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32639,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32640,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32895,
		32640,
		32895,
		32895,
		32896,
		32895,
		32640,
		32896,
		32896,
		32896,
		32640,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32895,
		32640,
		32895,
		32896,
		32895,
		32896,
		32896,
		32896,
		32640,
		32896,
		32640,
		32640,
		32639,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32640,
		32639,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32895,
		32896,
		32896,
		32896,
		32896,
		32639,
		32639,
		32895,
		32895,
		32896,
		32640,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32895,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32895,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32895,
		32895,
		32896,
		32895,
		32896,
		32896,
		32896,
		32640,
		32895,
		32640,
		32896,
		32895,
		32895,
		32895,
		32896,
		32895,
		32895,
		32895,
		32640,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32640,
		32640,
		32639,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32896,
		32639,
		32640,
		32896,
		32640,
		32896,
		32640,
		32640,
		32895,
		32896,
		32895,
		32895,
		32896,
		32896,
		32896,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32640,
		32639,
		32896,
		32895,
		32895,
		32896,
		32895,
		32639,
		32640,
		32895,
		32895,
		32896,
		32896,
		32640,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32895,
		32896,
		32895,
		32640,
		32639,
		32896,
		32896,
		32896,
		32896,
		32639,
		32640,
		32896,
		32896,
		32640,
		32896,
		32895,
		32895,
		32640,
		32896,
		32896,
		32640,
		32895,
		32896,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32640,
		32896,
		32896,
		32639,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32895,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32640,
		32896,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32895,
		32895,
		32896,
		32640,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32639,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32895,
		32639,
		32640,
		32640,
		32640,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32895,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32896,
		32639,
		32895,
		32895,
		32640,
		32639,
		32640,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32639,
		32895,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32640,
		32895,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32640,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32639,
		32640,
		32896,
		32640,
		32640,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32639,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32640,
		32895,
		32896,
		32640,
		32896,
		32639,
		32896,
		32896,
		32895,
		32640,
		32896,
		32896,
		32640,
		32640,
		32896,
		32895,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32640,
		32640,
		32639,
		32896,
		32896,
		32895,
		32640,
		32895,
		32895,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32896,
		32895,
		32640,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32639,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32640,
		32895,
		32639,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32896,
		32639,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32895,
		32896,
		32640,
		32640,
		32896,
		32896,
		32639,
		32895,
		32896,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32640,
		32640,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32896,
		32640,
		32896,
		32895,
		32896,
		32896,
		32639,
		32896,
		32896,
		32639,
		32895,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32639,
		32896,
		32895,
		32895,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32640,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32640,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32639,
		32896,
		32639,
		32896,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32895,
		32639,
		32896,
		32896,
		32896,
		32640,
		32640,
		32639,
		32896,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32895,
		32639,
		32640,
		32895,
		32895,
		32895,
		32896,
		32896,
		32895,
		32640,
		32896,
		32640,
		32640,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32640,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32895,
		32895,
		32895,
		32639,
		32895,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32640,
		32896,
		32895,
		32896,
		32896,
		32896,
		32895,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32639,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32639,
		32895,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32639,
		32895,
		32896,
		32895,
		32895,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32640,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32895,
		32896,
		32895,
		32640,
		32896,
		32895,
		32896,
		32896,
		32640,
		32640,
		32896,
		32640,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32895,
		32896,
		32640,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32639,
		32895,
		32896,
		32639,
		32896,
		32896,
		32639,
		32895,
		32895,
		32639,
		32896,
		32640,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32640,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32640,
		32896,
		32895,
		32895,
		32896,
		32896,
		32895,
		32896,
		32640,
		32896,
		32640,
		32896,
		32895,
		32639,
		32895,
		32639,
		32639,
		32896,
		32896,
		32896,
		32639,
		32640,
		32896,
		32640,
		32896,
		32640,
		32896,
		32895,
		32896,
		32895,
		32639,
		32640,
		32895,
		32896,
		32896,
		32639,
		32640,
		32640,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32895,
		32895,
		32896,
		32896,
		32896,
		32895,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32639,
		32896,
		32639,
		32895,
		32896,
		32640,
		32896,
		32896,
		32640,
		32639,
		32896,
		32896,
		32896,
		32895,
		32895,
		32896,
		32896,
		32639,
		32640,
		32896,
		32896,
		32640,
		32896,
		32895,
		32640,
		32640,
		32896,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32896,
		32640,
		32639,
		32640,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32895,
		32895,
		32896,
		32895,
		32896,
		32895,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32896,
		32640,
		32640,
		32639,
		32896,
		32896,
		32896,
		32640,
		32896,
		32639,
		32896,
		32896,
		32639,
		32640,
		32640,
		32896,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32639,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32640,
		32640,
		32896,
		32640,
		32896,
		32896,
		32895,
		32896,
		32639,
		32896,
		32640,
		32896,
		32895,
		32896,
		32895,
		32895,
		32640,
		32896,
		32896,
		32896,
		32895,
		32896,
		32896,
		32895,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32896,
		32640,
		32896,
		32896,
		32896,
		32639,
		32896,
		32896,
		32895,
		32896,
		32896,
		32640,
		32896,
		32640,
		32639,
		32895,
		32640,
		32895,
		32640,
		32896,
		32896,
		32895,
		32896,
		32640,
		32896,
		32896,
		32639,
		32896,
		32896,
		32896
	};


// FFT data transfer to VGA
//unsigned int rangeFreq[] = {91, 173, 268, 378, 506,
//							   655, 828, 1028, 1261, 1531,
//							   1844, 2207, 2629, 3119, 3687,
//							   4346, 5112, 6000, 13000, 20000};
unsigned int rangeFreq[] = {1000, 2000, 3000, 4000, 5000,
							6000, 7000, 8000, 9000, 10000,
							11000, 12000, 13000, 14000, 15000,
							16000, 17000, 18000, 19000, 20000};

unsigned int occurFreq[] = {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

// Pointer to VGA controller
volatile unsigned *vga = (volatile unsigned *) VGA_INTEGRATE_0_BASE;

int main()
{
	alt_putstr("Hello from Nios II!\n");

  // Initialize the image array and VGA screen to contain all black pixels
  for( int x = 0; x < 160; x++ ) {
	  for( int y = 0; y < 120; y++ ) {
		  image[x][y] = 0;
		  *vga = (y << 24) | (x << 16) | 0;
	  }
  }

  // Initialize the hardware timer
  init_isr();

  /* Event loop never exits. */
  while (1);

  return 0;
}

// Setup the hardware timer
void init_isr(void){
	alt_ic_isr_register(TIMER_0_IRQ_INTERRUPT_CONTROLLER_ID, TIMER_0_IRQ, (void *)vert_time_isr, NULL, 0x0);

	IOWR_ALTERA_AVALON_TIMER_CONTROL(TIMER_0_BASE, ALTERA_AVALON_TIMER_CONTROL_CONT_MSK | ALTERA_AVALON_TIMER_CONTROL_START_MSK | ALTERA_AVALON_TIMER_CONTROL_ITO_MSK);
}

static void hori_time_isr(void * context, alt_u32 id) {
	static int sizes[] = {50, 40, 30, 20, 10,
							  10, 20, 30, 40, 50,
							  50, 40, 30, 20, 10,
							  10, 20, 30, 40, 50};
	static int colors[] = {0b000001, 0b000001, 0b000001, 0b000001, 0b000001,
							0b000001, 0b000001, 0b000001, 0b000001, 0b000001,
							0b000001, 0b000001, 0b000001, 0b000001, 0b000001,
							0b000001, 0b000001, 0b000001, 0b000001, 0b000001};

	IOWR_ALTERA_AVALON_TIMER_STATUS(TIMER_0_BASE, 0);

	// Display and update image
	for( int i = 0; i < 160; i++) {
		for( int j = 0; j < 120; j++  ) {
			if (j % 6 != 0) {
				*vga = (j << 24) | (i << 16) | image[i][j];
				image[i][j] = (i > sizes[j/6] && i < 160-sizes[j/6]) ? colors[j/6] : 0;
			}
		}
	}

	// Change Size and Color
		for (int i = 0; i < 20; i++) {
			// size change
			if (sizes[i] < 10 || sizes[i] > 50) {
				sizes[i] = 30;
			} else {
				if (rand() % 2 == 0) {
					sizes[i] += (rand() % 5);
				} else {
					sizes[i] -= (rand() % 5);
				}
			}

			// color change
			if (rand() % 5 == 0) {
				if (colors[i] == 0b000011) {
						colors[i] = 0b000001;
				} else {
						colors[i]++;
				}
			}
		}
}

// Update the image array and display it on the VGA screen
static void vert_time_isr(void * context, alt_u32 id){
	static int progress = 0;

	IOWR_ALTERA_AVALON_TIMER_STATUS(TIMER_0_BASE, 0);
	progress++;
	if (progress % 20 == 0) {
		runfft((int)(progress/20));
	} else {
		runvga(progress%20);
	}
}

void fft(cplx buf[], int n)
{
	cplx out[n];
	for (int i = 0; i < n; i++){
		out[i] = buf[i];
	}
	fft_helper(buf, out, N, 1);
}

void fft_helper(cplx buf[], cplx out[], int n, int step)
{
	if (step < n) {
		fft_helper(out, buf, n, step * 2);
		fft_helper(out + step, buf + step, n, step * 2);

		for (int i = 0; i < n; i += 2 * step) {
			cplx t = cexp(-I * M_PI * i / n) * out[i + step];
			buf[i / 2]     = out[i] + t;
			buf[(i + n)/2] = out[i] - t;
		}
	}
}

// Convert fft output to magnitude of frequencies
void printcplxArr(cplx arr[], int size){
	for (int i = 0; i < size; i++){
		if (!cimag(arr[i])) {
			real[i] = (int) creal(arr[i]);
			imag[i] = 0;
		} else {
			real[i] = (int) creal(arr[i]);
			imag[i] = (int) cimag(arr[i]);
		}

		magn[i] = (real[i]*real[i] + imag[i]*imag[i]);
		freq[i] = i * 11025 / N;
	}
}

// Run one instance of the fft calculation
void runfft(int index) {
	// Copy data being processed
	for (int i = index; i < N+index; i++) {
		output[i] = data[i];
	}
	// Reset recurrent frequency data
	for (int i = 0; i < 20; i++) {
		occurFreq[i] = 0;
	}

	// FFT and frequency magnitude calculation
	fft(output, N);
	printcplxArr(output, N);

	// Sort frequency and magnitude arrays
	// Currently O(n^2) --> Change to O(nlogn)
	for (int i = 0; i < N; i++) {
		for (int j = 0; j < N-1; j++) {
			if (magn[j] > magn[j+1]) {
				unsigned int temp = magn[j];
				magn[j] = magn[j+1];
				magn[j+1] = temp;

				temp = freq[j];
				freq[j] = freq[j+1];
				freq[j+1] = temp;
			}
		}
	}

	// Update the most recurrent frequencies
	for (int i = N; i >= N-30; i--) {
		for (int j = 0; j < 20; j++) {
			if ((signed int)(rangeFreq[j]-freq[i]) > 0) {
				occurFreq[j]++;
				break;
			}
		}
	}
}

// Update 1 frame on VGA output
void runvga(int change) {
	// Display and update image
		for( int j = 0; j < 120; j++ ) {
			for( int i = 0; i < 160; i++ ) {
				if (i % 8 != 0 && i % 8 != 1 ) {
					*vga = (j << 24) | (i << 16) | image[i][j];
					image[i][j] = (j < (sizes[i/8] + 10) || j > (110 - sizes[i/8])) ? colors[i/8] : 0;
				}
			}
		}

		// Change Size and Color
		for (int i = 0; i < 20; i++) {
			// size change
			if (change == 1) {
				sizes[i] = 3*occurFreq[i];
			}
			else {
				if (rand() % 3 == 0) {
					sizes[i] += (rand() % 2);
				} else if (rand() % 3 == 1) {
					sizes[i] -= (rand() % 2);
				}
			}

			// color change
			if (rand() % 5 == 0) {
				if (colors[i] == 0b000011) {
						colors[i] = 0b000001;
				} else {
						colors[i]++;
				}
			}
		}
}
